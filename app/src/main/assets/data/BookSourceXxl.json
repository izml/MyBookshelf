{
  "bookSourceUrl": "https://www.kaixin7days.com",
  "bookSourceName": "消消乐听书",
  "bookSourceGroup": "听书",
  "bookSourceType": "AUDIO",
  "loginUrl": "var loginInfo = source.getLoginInfo()\nvar json = java.getResponse(\"https://www.kaixin7days.com/login@\" + loginInfo).body()\nvar loginRes = JSON.parse(json)\nvar header = null\nif (loginRes.statusCode == 200) {\n    var accessToken = {\n        Authorization: \"Bearer \" + loginRes.content.accessToken\n    }\n    header = JSON.stringify(accessToken)\n    source.putLoginHeader(header)\n}\nheader",
  "loginUi": "[{\"name\": \"telephone\",\"type\": \"text\"},{\"name\": \"password\",\"type\": \"password\"}]",
  "loginCheckJs": "var strRes = result\nvar c = JSON.parse(result.body())\nif (c.statusCode == 301) {\n    var loginInfo = source.getLoginInfo()\n    var dl = null\n    if (loginInfo) {\n        dl = java.getResponse(\"https://www.kaixin7days.com/login@\" + loginInfo).body()\n    } else {\n        dl = java.getResponse(\"https://www.kaixin7days.com/visitorLogin@{}\").body()\n    }\n    c = JSON.parse(dl)\n    var accessToken = {\n        Authorization: \"Bearer \" + c.content.accessToken\n    }\n    var header = JSON.stringify(accessToken)\n    source.putLoginHeader(header)\n    strRes = java.getResponse(\"@Header:\" + header + url)\n}\nstrRes",
  "serialNumber": -100,
  "enable": true,
  "ruleFindUrl": "@js:var header = source.getLoginHeader()\nvar json = \"\"\nvar j = null\nif (header != null) {\n    json = java.getResponse(\"@Header:\" + header + \"https://www.kaixin7days.com/book-service/bookMgt/getBookCategroy@{}\").body()\n    j = JSON.parse(json)\n}\nif (j == null || j.statusCode == 301) {\n    json = java.getResponse(\"https://www.kaixin7days.com/visitorLogin@{}\").body()\n    j = JSON.parse(json)\n    var accessToken = {\n        Authorization: \"Bearer \" + j.content.accessToken\n    }\n    header = JSON.stringify(accessToken)\n    source.putLoginHeader(header)\n    json = java.getResponse(\"@Header:\" + header + \"https://www.kaixin7days.com/book-service/bookMgt/getBookCategroy@{}\").body()\n    j = JSON.parse(json)\n}\nvar fls = j.content\nvar fx = \"\"\nfor (var i = 0; i < fls.length; i++) {\n    fx = fx + fls[i].categoryName + '::/book-service/bookMgt/getAllBookByCategroyId@{\"categoryIds\": \"' + fls[i].associationCategoryIDs + '\",\"pageNum\": {{searchPage}},\"pageSize\": 100}&&'\n}\nfx",
  "ruleFindList": "$.content.content",
  "ruleFindName": "$.title",
  "ruleFindAuthor": "$.author",
  "ruleFindKind": "",
  "ruleFindIntroduce": "$.desc",
  "ruleFindLastChapter": "$.newestChapter",
  "ruleFindCoverUrl": "$.cover@js:var cover = JSON.parse(result);'https://www.shuidi.online:9021/fileMgt/getPicture?filePath='+cover.storeFilePath",
  "ruleFindNoteUrl": "$.id@js:'https://www.kaixin7days.com/book-service/bookMgt/getAllChapterByBookId@{\"bookId\": \"'+result+'\",\"pageNum\": 1,\"pageSize\": 100}'",
  "ruleChapterList": "$.content.content",
  "ruleChapterName": "$.chapterTitle",
  "ruleContentUrl": "@js:\"https://www.shuidi.online:9021/fileMgt/getAudioByChapterId?bookId=\"\n    + java.getString(\"$.bookId\") + \"&chapterId=\" + java.getString(\"$.id\")\n    + \"&pageNum=1&pageSize=50&{{var header = JSON.parse(source.getLoginHeader());'Authorization=' + header.Authorization}}\"",
  "ruleBookContent": ""
}